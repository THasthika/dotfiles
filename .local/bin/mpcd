#!/bin/bash

lockfile=/tmp/mpcd.lock

[[ $1 == "-f" ]] && rm -f $lockfile

[ -f $lockfile ] && exit 0

function daemon_mode {

	echo "started!"
	
	trap "{ rm -f $lockfile; }" EXIT

	echo "$$" > $lockfile

	while true
	do
		mpc idle >> /dev/null
		pkill -RTMIN+12 i3blocks
	done

}

daemon_mode < /dev/null > /dev/null 2>&1 &
disown

#daemon_mode
